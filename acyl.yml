---
version: 2

target_branches:
  - master

application:
  chart_repo_path: 'Pluto-tv/kvetch@main:charts/v2/devops/acyl'
  chart_vars_repo_path: 'Pluto-tv/kvetch@main:charts/v2/devops/acyl/environments/values-dqa.yaml'
  image: '972525491246.dkr.ecr.us-east-1.amazonaws.com/acyl'
  value_overrides:
# local:
#    - "image.pullPolicy=IfNotPresent"
#    - "app.ui.enforceOauth=false"
#    - "app.datadog.statsdAddr="
#    - "app.datadog.tracingAgentAddr="
#    - "app.secretsBackend=env"
#    - "app.secretsMapping={{ .ID }}"
#    - "app.operationTimeoutOverride=10m"
#    - "app.uiBaseUrl=http://192.168.64.10:4000"

dependencies:
  direct:
    - repo: Pluto-tv/furan
      name: service-furan
      value_overrides:
        - 'app.builderImage='
    - name: postgres-acyl
      chart_repo_path: 'helm/charts@master:stable/postgresql'
      value_overrides:
        - "image.tag=11"
        - "postgresqlPassword=root"
        - "postgresqlDatabase=acyl"
        - "persistence.enabled=false"
        - "fullnameOverride=postgresql-acyl"

notifications:
  github:
    commit_statuses:
      templates:
        success:
          description: 'The Acyl environment {{ .EnvName }} was created successfully.'
          target_url: 'https://www.youtube.com/watch?v=8hP9D6kZseM'
  templates:
    success:
      title: "üèÅ Success"
      sections:
        - title: "{{ .EnvName }}"
          text: "{{ .Repo }} PR #{{ .PullRequest }} {{ .SourceBranch }}\nK8s Namespace: {{ .K8sNamespace }}"
          style: 'good'
